<div class="container-home">
	<h3 class="recent-articles heading_all_sections_top">
		<span><svg xmlns="http://www.w3.org/2000/svg" width="15" height="19" viewBox="0 0 15 19">
					  <path id="Path_30541" data-name="Path 30541" d="M14.75,5.5V3.04l4.21,4.21H16.5A1.758,1.758,0,0,1,14.75,5.5ZM16.5,8.75A3.256,3.256,0,0,1,13.25,5.5v-3H9A4.507,4.507,0,0,0,4.5,7V17A4.507,4.507,0,0,0,9,21.5h6A4.507,4.507,0,0,0,19.5,17V8.75Z" transform="translate(-4.5 -2.5)" fill="currentColor"></path>
					</svg>
			{{LANG create_new_post}}
		</span>
	</h3>

	<form action="" class="create-post-form" id="create_post_form" method="POST">
		<div class="row">
			<div class="col-md-4">
				<div class="upload_video_bg_color">
					<div class="pt_upload_vdo_preview">
						<div class="pt_upload_vdo_thumb">
							<div class="upload-product-image" onclick="document.getElementById('image').click(); return false">
								<div class="upload-image-content">
									<svg enable-background="new 0 0 510 510" height="100%" viewBox="0 0 510 510" width="100%" xmlns="http://www.w3.org/2000/svg"><linearGradient id="SVGID_1_" gradientTransform="matrix(.994 .11 -.11 .994 -28.962 -29.776)" gradientUnits="userSpaceOnUse" x1="172.48" x2="497.848" y1="110.639" y2="436.007"><stop offset="0" stop-color="#ffa936"></stop><stop offset=".4112" stop-color="#ff8548"></stop><stop offset=".7781" stop-color="#ff6c54"></stop><stop offset="1" stop-color="#ff6359"></stop></linearGradient><linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="490.487" x2="466.43" y1="159.015" y2="164.322"><stop offset="0" stop-color="#f82814" stop-opacity="0"></stop><stop offset="1" stop-color="#c0272d"></stop></linearGradient><linearGradient id="lg1"><stop offset="0" stop-color="#cdec7a"></stop><stop offset=".2157" stop-color="#b0e995"></stop><stop offset=".5613" stop-color="#87e4bb"></stop><stop offset=".8347" stop-color="#6ee1d2"></stop><stop offset="1" stop-color="#65e0db"></stop></linearGradient><linearGradient id="SVGID_3_" gradientTransform="matrix(.983 -.185 .185 .983 55.608 42.369)" gradientUnits="userSpaceOnUse" x1="15.52" x2="340.888" xlink:href="#lg1" y1="104.705" y2="430.073"></linearGradient><linearGradient id="lg2"><stop offset="0" stop-color="#cdec7a" stop-opacity="0"></stop><stop offset=".2354" stop-color="#9ad57d" stop-opacity=".235"></stop><stop offset=".6035" stop-color="#51b482" stop-opacity=".604"></stop><stop offset=".8679" stop-color="#239f85" stop-opacity=".868"></stop><stop offset="1" stop-color="#119786"></stop></linearGradient><linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="491.682" x2="450.637" xlink:href="#lg2" y1="256.546" y2="256.546"></linearGradient><linearGradient id="SVGID_5_" gradientUnits="userSpaceOnUse" x1="176.731" x2="176.731" xlink:href="#lg2" y1="466.917" y2="442.601"></linearGradient><linearGradient id="SVGID_6_" gradientUnits="userSpaceOnUse" x1="88.264" x2="413.632" y1="111.753" y2="437.121"><stop offset="0" stop-color="#f8f6fb"></stop><stop offset="1" stop-color="#efdcfb"></stop></linearGradient><linearGradient id="SVGID_7_" gradientUnits="userSpaceOnUse" x1="112.768" x2="430.112" y1="101.155" y2="514.021"><stop offset="0" stop-color="#18cefb"></stop><stop offset=".2969" stop-color="#2bb9f9"></stop><stop offset=".7345" stop-color="#42a0f7"></stop><stop offset="1" stop-color="#4a97f6"></stop></linearGradient><linearGradient id="SVGID_8_" gradientUnits="userSpaceOnUse" x1="75.588" x2="214.616" y1="316.53" y2="497.406"><stop offset="0" stop-color="#cdec7a"></stop><stop offset=".2154" stop-color="#b0e995" stop-opacity=".784"></stop><stop offset=".5604" stop-color="#87e4bb" stop-opacity=".439"></stop><stop offset=".8334" stop-color="#6ee1d2" stop-opacity=".165"></stop><stop offset=".9985" stop-color="#65e0db" stop-opacity="0"></stop></linearGradient><linearGradient id="SVGID_9_" gradientUnits="userSpaceOnUse" x1="198.822" x2="366.499" xlink:href="#lg1" y1="288.474" y2="506.622"></linearGradient><linearGradient id="SVGID_10_" gradientUnits="userSpaceOnUse" x1="117.242" x2="171.618" y1="131.922" y2="202.666"><stop offset="0" stop-color="#ffd945"></stop><stop offset=".3043" stop-color="#ffcd3e"></stop><stop offset=".8558" stop-color="#ffad2b"></stop><stop offset="1" stop-color="#ffa325"></stop></linearGradient><g><path d="m426.926 470.539-386.877-42.878c-18.601-2.061-32.008-18.811-29.947-37.412l35.559-320.841c2.062-18.601 18.812-32.009 37.412-29.947l386.877 42.878c18.601 2.062 32.009 18.812 29.947 37.412l-35.559 320.841c-2.061 18.601-18.811 32.009-37.412 29.947z" fill="url(#SVGID_1_)"></path><path d="m499.897 119.752-14.02 126.534-31.162-165.634 15.241 1.688c18.595 2.058 32 18.806 29.941 37.412z" fill="url(#SVGID_2_)"></path><path d="m482.373 410.94-382.536 71.964c-18.392 3.46-36.107-8.645-39.567-27.037l-59.68-317.241c-3.46-18.392 8.645-36.107 27.037-39.567l382.536-71.964c18.392-3.46 36.107 8.645 39.567 27.037l59.68 317.241c3.46 18.393-8.645 36.108-27.037 39.567z" fill="url(#SVGID_3_)"></path><path d="m457.896 97.546v317.999l24.476-4.605c18.392-3.46 30.497-21.175 27.037-39.567z" fill="url(#SVGID_4_)"></path><path d="m58.45 446.187 1.821 9.68c3.46 18.392 21.175 30.497 39.567 27.037l195.175-36.717z" fill="url(#SVGID_5_)"></path><g><path d="m424.01 448.166h-389.245c-18.715 0-33.886-15.171-33.886-33.886v-322.806c0-18.715 15.171-33.886 33.886-33.886h389.245c18.715 0 33.886 15.171 33.886 33.886v322.806c0 18.715-15.171 33.886-33.886 33.886z" fill="url(#SVGID_6_)"></path><path d="m392.279 416.326h-325.782c-15.663 0-28.361-12.698-28.361-28.361v-270.175c0-15.663 12.698-28.361 28.361-28.361h325.782c15.663 0 28.361 12.698 28.361 28.361v270.175c0 15.663-12.698 28.361-28.361 28.361z" fill="url(#SVGID_7_)"></path><g><path d="m252.069 416.326h-185.567c-15.666 0-28.37-12.694-28.37-28.359v-44.29l47.082-57.228c15.538-18.903 44.46-18.903 60.009 0l29.315 35.64z" fill="url(#SVGID_8_)"></path><path d="m420.643 316.75v71.217c0 15.666-12.704 28.359-28.37 28.359h-295.268l77.532-94.237 95.246-115.783c15.538-18.892 44.471-18.892 60.009 0z" fill="url(#SVGID_9_)"></path></g><circle cx="137.225" cy="157.919" fill="url(#SVGID_10_)" r="40.219"></circle></g></g></svg>
								</div>
							</div>
							<input id="image" name="image" type="file" class="hidden" accept="image/*">
						</div>
					</div>
				</div>
			</div>
			
			<div class="col-md-8">
				<div class="upload_video_bg_color step_2_form">
					<div class="progress hidden">
						<span class="percent">0%</span>
						<div class="progress_bar_parent">
							<div class="bar upload-progress-bar progress-bar active"></div> 
						</div>
						<div class="clear"></div>
						<div class="text-center pt_prcs_vdo"></div>
					</div>
					<div class="form-group">
						<label for="text">{{LANG write_message}}</label>  
						<textarea name="text" id="text" cols="30" rows="8" class="form-control"></textarea>
					</div>
					<div class="text-center">
						<button type="submit" id="submit-btn" class="btn btn-main upload_custom_new">{{LANG publish}}</button>
					</div>
				</div>
			</div>
		</div>
	</form>
</div>

<script>
$(document).ready(function() {
	$("#image").on('change', function() {
	//Get count of selected files
	var product_countFiles = $(this)[0].files.length;
	var product_imgPath = $(this)[0].value;
	var extn = product_imgPath.substring(product_imgPath.lastIndexOf('.') + 1).toLowerCase();
	var product_image_holder = $(".upload-image-content");
	product_image_holder.empty();
	if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
		if (typeof(FileReader) != "undefined") {
		//loop for each file selected for uploaded.
		for (var i = 0; i < product_countFiles; i++) 
		{
			var product_reader = new FileReader();
			product_reader.onload = function(e) {
				$("<img />", {
                    "src": e.target.result,
                    "class": "thumb-image"
                  }).appendTo(product_image_holder);
                }
                product_image_holder.show();
                product_reader.readAsDataURL($(this)[0].files[i]);
              }
            } else {
              product_image_holder.html("<p>This browser does not support FileReader.</p>");
            }
         }
	});
});

$(function () {
	var bar         = $('.bar');
    var percent     = $('.percent');
    var prcsvdo      = $('.pt_prcs_vdo');

	$('#create_post_form').ajaxForm({
	    url: '{{LINK aj/post/create}}?hash=' + $('.main_session').val(),
	    beforeSend: function() {
	    	$('#submit-btn').attr('disabled', true);
	    	$('#submit-btn').val("{{LANG please_wait}}");
	    	$('.progress').removeClass('hidden');
            var percentVal = '0%';
            bar.width(percentVal);
            percent.html(percentVal);
	    },
        uploadProgress: function(event, position, total, percentComplete) {
             if(percentComplete > 50) {
                percent.addClass('white');
             }
            var percentVal = percentComplete + '%';
            bar.width(percentVal);
            percent.html(percentVal);

            if (percentComplete == 100) {
               prcsvdo.html('<svg width="30" height="10" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#000"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg> {{LANG porcessing_image}}');
               $('.progress').find('.bar').removeClass('upload-progress-bar');
            }
        },
	    success: function(data) {
	    	percentVal = '0%';
            bar.width(percentVal);
            $('.progress').addClass('hidden');
	    	if (data.status == 200) {
	    		Snackbar.show({text: "<div>{{LANG post_created}}</div>"});
	    		setTimeout(function () {
	    			window.location.href = data.link;
	    		},3000)
	    	} 
	        else {
	    		$('#submit-btn').attr('disabled', false);
	    	    $('#submit-btn').val("{{LANG publish}}");
				Snackbar.show({text: "<div>"+ data.message +"</div>"});
	    	}
	    }
	});
});

</script>